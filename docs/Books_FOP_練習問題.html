<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" data-scrapbook-source="https://wiki.haskell.jp/Old/sampou.org/Books_FOP_%e7%b7%b4%e7%bf%92%e5%95%8f%e9%a1%8c"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Haskell-jp wiki - Old/sampou.org/Books_FOP_練習問題</title>
    <link href="jquery-ui.min.css" rel="stylesheet" media="print" type="text/css">
        <link href="custom.css" rel="stylesheet" media="screen, projection" type="text/css">
    <link href="print.css" rel="stylesheet" media="print" type="text/css">
    
    <!--[if IE]><link href="/css/ie.css" rel="stylesheet" media="screen, projection" type="text/css" /><![endif]-->
  </head>
  <body>
    <div id="doc3" class="yui-t1">
        <div id="yui-main">
          <div id="maincol" class="yui-b">
            <div id="userbox">
  <noscript>
    <a href="https://wiki.haskell.jp/_login">Login</a>
    <a href="index.html">Logout</a>
  </noscript>
  &nbsp;
  <a id="loginlink" class="login" href="https://wiki.haskell.jp/_login">Login / Get an account</a>
  <a id="logoutlink" class="login" href="index.html">Logout <span id="logged_in_user"></span></a>
</div>
            <ul class="tabs"><li class="selected"><a href="">view</a></li><li><a href="https://wiki.haskell.jp/_edit/Old/sampou.org/Books_FOP_%e7%b7%b4%e7%bf%92%e5%95%8f%e9%a1%8c">edit</a></li><li><a href="https://wiki.haskell.jp/_history/Old/sampou.org/Books_FOP_%e7%b7%b4%e7%bf%92%e5%95%8f%e9%a1%8c">history</a></li><li><a href="https://wiki.haskell.jp/_discuss/Old/sampou.org/Books_FOP_%e7%b7%b4%e7%bf%92%e5%95%8f%e9%a1%8c">discuss</a></li></ul> 
            <div id="content">
  
  <h1 class="pageTitle"><a href="">Old/sampou.org/Books_FOP_練習問題</a></h1>
  
  <div id="wikipage"><div id="TOC">
<ul>
<li><a href="#books_fop_%E7%B7%B4%E7%BF%92%E5%95%8F%E9%A1%8C"><span>Books_FOP_練習問題</span></a><ul>
<li><a href="#%E7%AC%AC1%E7%AB%A0">第1章</a></li>
<li><a href="#%E7%AC%AC2%E7%AB%A0">第2章</a></li>
<li><a href="#%E7%AC%AC3%E7%AB%A0">第3章</a></li>
<li><a href="#%E7%AC%AC4%E7%AB%A0">第4章</a></li>
<li><a href="#%E7%AC%AC5%E7%AB%A0">第5章</a></li>
<li><a href="#%E7%AC%AC6%E7%AB%A0">第6章</a></li>
<li><a href="#%E7%AC%AC7%E7%AB%A0">第7章</a></li>
<li><a href="#%E7%AC%AC8%E7%AB%A0">第8章</a></li>
<li><a href="#%E7%AC%AC9%E7%AB%A0">第9章</a></li>
<li><a href="#%E7%AC%AC10%E7%AB%A0-%E3%82%A2%E3%83%AD%E3%83%BC%E3%81%A8%E8%A8%88%E7%AE%97">第10章 アローと計算</a></li>
<li><a href="#%E7%AC%AC11%E7%AB%A0">第11章</a></li>
<li><a href="#%E7%AC%AC12%E7%AB%A0">第12章</a></li>
</ul></li>
</ul>
</div>

<h1 id="books_fop_練習問題"><a href="" class="uri" title="Go to wiki page">Books_FOP_練習問題</a></h1>
<p><a href="Books.html" class="uri" title="Go to wiki page">Books</a>:<a href="https://wiki.haskell.jp/Old/sampou.org/FOP" class="uri" title="Go to wiki page">FOP</a>:練習問題</p>
<hr>
<p>みんなでFOP（『関数プログラミングの楽しみ』）の練習問題の解答集を作りましょう。</p>
<hr>
<h3 id="第1章">第1章</h3>
<h3 id="第2章">第2章</h3>
<h3 id="第3章">第3章</h3>
<h3 id="第4章">第4章</h3>
<h3 id="第5章">第5章</h3>
<p>机上で全てやるよりも実際のシステムを使えた方が良いと思うので、とりあえず MAG の使い方に関するページを作っておきました。</p>
<ul>
<li><a href="Books_FOP_MAG.html" class="uri" title="Go to wiki page">Books_FOP_MAG</a></li>
</ul>
<h3 id="第6章">第6章</h3>
<h3 id="第7章">第7章</h3>
<h3 id="第8章">第8章</h3>
<h4 id="練習問題-8.16">練習問題 8.16</h4>
<p><a href="https://hackage.haskell.org/packages/archive/Wired/0.2/doc/html/src/Lava-Patterns.html" class="uri">http://hackage.haskell.org/packages/archive/Wired/0.2/doc/html/src/Lava-Patterns.html</a> より</p>
<pre><code> zipp :: ([a],[b]) -&gt; [(a,b)]
 zipp ([],[])      = []
 zipp (a:as, b:bs) = (a,b) : zipp (as, bs)
 zipp _ = error "Lava.Patterns.zipp: Different lengths"
 
 unpair :: [(a,a)] -&gt; [a]
 unpair []          = []
 unpair ((x,y):xys) = x : y : unpair xys
 
 riffle :: [a] -&gt; [a]
 riffle = halveList -&gt;- zipp -&gt;- unpair</code></pre>
<h4 id="練習問題-8.17">練習問題 8.17</h4>
<p><a href="https://hackage.haskell.org/packages/archive/Wired/0.2/doc/html/src/Lava-Patterns.html" class="uri">http://hackage.haskell.org/packages/archive/Wired/0.2/doc/html/src/Lava-Patterns.html</a> より</p>
<pre><code> unzipp :: [(a,b)] -&gt; ([a],[b])
 unzipp = unzip
 
 pair :: [a] -&gt; [(a,a)]
 pair (x:y:xs) = (x,y) : pair xs
 pair _        = []
 
 unriffle :: [a] -&gt; [a]
 unriffle = pair -&gt;- unzipp -&gt;- append</code></pre>
<h4 id="練習問題-8.18">練習問題 8.18</h4>
<ul>
<li>簡単のためトランプカードを 0番目、1番目、2番目… と 0から番号を数えることにする。</li>
<li>１回 riffle するとi番目のカードは i &lt; 2^(n-1) のときは 2*i番目に移り、2^(n-1) &lt;= i &lt; 2^n-1 のときは 2*i-2^n+1 番目に移り、i == 2^n-1 のときは 2^n-1番目のままになる。</li>
<li>まとめると i &lt; 2^n-1 のときは 2*i mod (2^n-1) 番目に移り、i == 2^n-1 のときは 2^n-1番目のままになる。</li>
<li>1番目のカードに注目すると riffle １回で 2^1番目に移り、riffle ２回目で 2^2番目に移り、riffle m回目（ただし m &lt; n）で 2^m番目に移り、n回目で初めて 1番目に戻る。（2^n == 1 mod (2^n-1) なので）</li>
<li>i番目（i &lt; 2^n-1 とする）のカードは riffle １回で 2^1*i mod (2^n-1)番目に移り、riffle ２回目で 2^2*i mod (2^n-1)番目に移り、riffle m回目（ただし m &lt; n）で 2^m*i mod (2^n-1)番目に移り、n回目は i番目に戻っている。（2^n*i == i mod (2^n-1) なので）</li>
<li>2^n-1番目のカードはずっと同じ位置なので riffle n回目でも同じ位置のままである。</li>
<li>まとめると、すべてのカードが揃って元の位置に戻るのは riffle を n回繰り返したときである。</li>
</ul>
<h4 id="練習問題-8.19">練習問題 8.19</h4>
<p>two と ilv が可換</p>
<pre><code> two(ilv f) = ilv(two f)</code></pre>
<p>と ilv と two の直列合成に関する分配</p>
<pre><code> ilv (f-&gt;-g) = ilv f -&gt;- ilv g
 two (f-&gt;-g) = two f -&gt;- two g</code></pre>
<p>を使って n に関する帰納法で</p>
<pre><code> bfly n f = bfly1 n f</code></pre>
<p>を証明する。</p>
<p>n = 1 のとき</p>
<pre><code> bfly 1 f = f = bfly1 1 f</code></pre>
<p>n = 2 のとき</p>
<pre><code> bfly 2 f = ilv (bfly 1 f) -&gt;- twoN 1 f
   = ilv f -&gt;- two f
 bfly1 2 f = ilvN 1 f -&gt;- two (bfly1 1 f)
   = ilv f -&gt;- two f</code></pre>
<p>n = k, k-1 のときの</p>
<pre><code> bfly k f = bfly1 k f
 bfly (k-1) f = bfly1 (k-1) f</code></pre>
<p>が成り立つとする。</p>
<pre><code> bfly (k+1) f = ilv (bfly k f) -&gt;- twoN k f   （bfly の定義）
   = ilv (bfly1 k f) -&gt;- twoN k f   （n = k のときの仮定）
   = ilv (ilvN (k-1) f -&gt;- two (bffy1 (k-1) f)) -&gt;- twoN k f   （bfly1 の定義）
   = ilv (ilvN (k-1) f) -&gt;- ilv (two (bfly1 (k-1) f)) -&gt;- twoN k f   （ilv に関する分配）
   = ilvN k f -&gt;- ilv (two (bfly1 (k-1) f)) -&gt;- twoN k f   （ilvN の定義）

 bfly1 (k+1) f = ilvN k f -&gt;- two (bfly1 k f)   （bfly1 の定義）
   = livN k f -&gt;- two (bfly k f)   （n = k のときの仮定）
   = ilvN k f -&gt;- two (ilv (bfly (k-1) f) -&gt;- twoN (k-1) f)   （bfly の定義）
   = ilvN k f -&gt;- two (ilv (bfly (k-1) f)) -&gt;- two (twoN (k-1) f)   （two に関する分配）
   = ilvN k f -&gt;- two (ilv (bfly (k-1) f)) -&gt;- twoN k f   （twoN の定義）</code></pre>
<p>二つの結果を見比べて ilv と two の可換と n = k-1 のときの仮定から</p>
<pre><code> bfly (k+1) f = bfly1 (k+1) f</code></pre>
<h4 id="練習問題-8.20">練習問題 8.20</h4>
<pre><code> bfly n f = ilv (bfly (n-1) g) -&gt;- twoN (n-1) g   （bfly の定義）
   = unriffle -&gt;- two (bfly (n-1) g) -&gt;- riffle -&gt;- twoN (n-1) g   （ilv の定義）
   = unriffle -&gt;- two (ilv (bfly (n-2) g -&gt;- twoN (n-2) g) -&gt;- riffle -&gt;- twoN (n-1) g   （bfly の定義）
   = unriffle -&gt;- two (ilv (bfly (n-2) g)) -&gt;- two (twoN (n-2) g)  -&gt;- riffle -&gt;- twoN (n-1) g   （two に関する分配）
   = unriffle -&gt;- ilv (two (bfly (n-2) g)) -&gt;- twoN (n-1) g  -&gt;- riffle -&gt;- twoN (n-1) g   （ilv と two の可換と twoN の定義）
   = unriffle -&gt;- unriffle -&gt;- two (two (bfly (n-2) g)) -&gt;- riffle -&gt;- twoN (n-1) g  -&gt;- riffle -&gt;- twoN (n-1)   （ilv の定義）
   = composeN 2 unriffle -&gt;- twoN 2 (bfly (n-2) g)) -&gt;- composeN 2 (riffle -&gt;- twoN (n-1) g)   （composeN の定義）
   = composeN 2 unriffle -&gt;- unriffle -&gt;- twoN 2 (two (bfly (n-3) g))) -&gt;- riffle -&gt;- twoN 2 (twoN (n-3) g)  -&gt;- composeN 2 (riffle -&gt;- twoN (n-1) g)   （上記と同様のことを繰り返す）
   = composeN 3 unriffle -&gt;- twoN 3 (bfly (n-3) g) -&gt;- composeN 3  (riffle -&gt;- twoN (n-1) g)   （composeN の定義を twoN と two の関係）
   …   （上記と同様のことを繰り返す）
   = composeN (n-1) unriffle -&gt;- twoN (n-1) (bfly 1 g) -&gt;- composeN (n-1)  (riffle -&gt;- twoN (n-1) g)
   = composeN (n-1) unriffle -&gt;- twoN (n-1) f -&gt;- composeN (n-1)  (riffle -&gt;- twoN (n-1) g)   （bfly 1 の定義）
   = composeN (n-1) unriffle -&gt;- unriffle -&gt;- riffle -&gt;- twoN (n-1) f -&gt;- composeN (n-1) (riffle -&gt;- twoN (n-1) g)   （unriffle -&gt;- riffle は id なるので）
   = composeN n unriffle -&gt;- composeN n (riffle -&gt;- twoN (n-1) g)   （composeN の定義）
   = composeN n (riffle -&gt;- twoN (n-1) g)   （練習問題 8.18 と同様に unriffle を n回繰り返すと id になるので）
   = shuffleEx n g</code></pre>
<h4 id="練習問題-8.22">練習問題 8.22</h4>
<pre><code> odds c (x:xs) = x: odds' xs
   where
     odds' (x1:x2:xs) = let [y1,y2] = c [x1,x2] in y1:y2: odds' xs
     odds' xs = xs</code></pre>
<h3 id="第9章">第9章</h3>
<h3 id="第10章-アローと計算">第10章 アローと計算</h3>
<h4 id="練習問題-10.1">練習問題 10.1</h4>
<h4 id="練習問題-10.2">練習問題 10.2</h4>
<h4 id="練習問題-10.3">練習問題 10.3</h4>
<h4 id="練習問題-10.4">練習問題 10.4</h4>
<pre><code> (f1&gt;&gt;&gt;f2) |× (g2.g1) == (f1 |× g1) &gt;&gt;&gt; (f2 |× g2)</code></pre>
<p>を示す。</p>
<pre><code> 左辺 = first (f1&gt;&gt;&gt;f2) &gt;&gt;&gt; pure (id × (g2.g1))   （|× の定義）
   = first f1 &gt;&gt;&gt; first f2 &gt;&gt;&gt; pure (id × (g2.g1))   （first の関手則）
   = first f1 &gt;&gt;&gt; first f2 &gt;&gt;&gt; pure ((id × g2).(id × g1))
   = first f1 &gt;&gt;&gt; first f2 &gt;&gt;&gt; pure (id × g1) &gt;&gt;&gt; pure (id × g2)   （pure の関手則）
   = first f1 &gt;&gt;&gt; pure (id × g1) &gt;&gt;&gt; first f2 &gt;&gt;&gt; pure (id × g2)   （first の交換則）
   = 右辺   （|× の定義）</code></pre>
<h4 id="練習問題-10.5">練習問題 10.5</h4>
<h4 id="練習問題-10.6">練習問題 10.6</h4>
<h4 id="練習問題-10.7">練習問題 10.7</h4>
<h4 id="練習問題-10.8">練習問題 10.8</h4>
<h4 id="練習問題-10.9">練習問題 10.9</h4>
<h4 id="練習問題-10.10">練習問題 10.10</h4>
<h4 id="練習問題-10.11">練習問題 10.11</h4>
<h4 id="練習問題-10.12">練習問題 10.12</h4>
<pre><code> loop (first f) = loop (first f &gt;&gt;&gt; idA)   （idA の恒等性）
   = f &gt;&gt;&gt; loop idA   （loop の左結合則）
   = f &gt;&gt;&gt; loop (pure id)   （idA の定義）
   = f &gt;&gt;&gt; pure (trace id)   （loop の拡張則）
   = f &gt;&gt;&gt; pure (\b -&gt; let (c,d) = id (b,d) in c)   （trace の定義）
   = f &gt;&gt;&gt; pure (\b -&gt; b)
   = f &gt;&gt;&gt; pure id
   = f &gt;&gt;&gt; idA   （idA の定義）
   = f   （idA の恒等性）</code></pre>
<h4 id="練習問題-10.13">練習問題 10.13</h4>
<h4 id="練習問題-10.14">練習問題 10.14</h4>
<pre><code> pure (\p -&gt; a) &gt;&gt;&gt; f == pure (\p -&gt; (f,a)) &gt;&gt;&gt; app</code></pre>
<p>を示す。</p>
<pre><code> 左辺 = pure (\p -&gt; a) &gt;&gt;&gt; mkPair f &gt;&gt;&gt; app    （外延性則）
   = pure (\p -&gt; a) &gt;&gt;&gt; pure (\a -&gt; (f,a)) &gt;&gt;&gt; app    （mkPair の定義）
   = pure ((\a -&gt; (f,a)).(\p -&gt; a)) &gt;&gt;&gt; app    （pure の関手則）
   = pure (\p -&gt; (f,a)) &gt;&gt;&gt; app    （関数の合成）
   = 右辺</code></pre>
<h4 id="練習問題-10.15">練習問題 10.15</h4>
<h4 id="練習問題-10.16">練習問題 10.16</h4>
<h4 id="練習問題-10.17">練習問題 10.17</h4>
<pre><code> (&gt;&lt;) :: (a -&gt; b) -&gt; (c -&gt; d) -&gt; (a,c) -&gt; (b,d)
 (f &gt;&lt; g) (x,y) = (f x, g y)
 
 (*#*) :: Hom a b -&gt; Hom a b -&gt; Hom (Pair a) (Pair b)
 (f :&amp;: fs) *#* (g :&amp;: gs) = (f &gt;&lt; g) :&amp;: (fs *#* gs)
 
 -- 「8.8 Batcher のマージャとソータ」の sortB 参照
 sort :: Ord a =&gt; Hom a a
 sort = (id :&amp;: (sort *#* (sort &gt;&gt;&gt; rev))) &gt;&gt;&gt; bisort</code></pre>
<h4 id="練習問題-10.18">練習問題 10.18</h4>
<h4 id="練習問題-10.19">練習問題 10.19</h4>
<h3 id="第11章">第11章</h3>
<h3 id="第12章">第12章</h3>
<hr>
<p>Last modified : 2011/02/04 19:07:05 JST</p></div>
</div>
            <div id="footer">powered by <a href="https://github.com/jgm/gitit/tree/master/">gitit</a> × <a href="https://haskellonheroku.com/">Haskell on Heroku</a></div>
          </div>
        </div>
        <div id="sidebar" class="yui-b first">
          <div id="logo">
  <a href="_-1.html" alt="site logo" title="Go to top page"><img src="logo.png"></a>
</div>
                      <div class="sitenav">
  <fieldset>
    <legend>Site</legend>
    <ul>
      <li><a href="_-1.html">Front page</a></li>
      <li><a href="_index.html">All pages</a></li>
      <li><a href="_categories.html">Categories</a></li>
      <li><a href="https://wiki.haskell.jp/_random">Random page</a></li>
      <li><a href="https://wiki.haskell.jp/_activity">Recent activity</a></li>
              <li><a href="https://wiki.haskell.jp/_upload">Upload a file</a></li>
      
      
      <li><a href="Help.html">Help</a></li>
    </ul>
    <form action="https://wiki.haskell.jp/_search" method="get" id="searchform">
     <input type="text" name="patterns" id="patterns" value="">
     <input type="submit" name="search" id="search" value="Search">
    </form>
    <form action="https://wiki.haskell.jp/_go" method="post" id="goform">
      <input type="text" name="gotopage" id="gotopage" value="">
      <input type="submit" name="go" id="go" value="Go">
    </form>
  </fieldset>
</div>
          
                      <div class="pageTools">
  <fieldset>
    <legend>This page</legend>
    <ul>
      <li><a href="https://wiki.haskell.jp/_showraw/Old/sampou.org/Books_FOP_%e7%b7%b4%e7%bf%92%e5%95%8f%e9%a1%8c">Raw page source</a></li>
      <li><a href="https://wiki.haskell.jp/Old/sampou.org/Books_FOP_%e7%b7%b4%e7%bf%92%e5%95%8f%e9%a1%8c?printable">Printable version</a></li>
      <li><a href="https://wiki.haskell.jp/_delete/Old/sampou.org/Books_FOP_%e7%b7%b4%e7%bf%92%e5%95%8f%e9%a1%8c">Delete this page</a></li>
      
    </ul>
    <form action="https://wiki.haskell.jp/Old/sampou.org/Books_FOP_%e7%b7%b4%e7%bf%92%e5%95%8f%e9%a1%8c" method="post" id="exportbox"><select name="format"><option value="LaTeX" selected="selected">LaTeX</option><option value="ConTeXt">ConTeXt</option><option value="Texinfo">Texinfo</option><option value="reST">reST</option><option value="Markdown">Markdown</option><option value="CommonMark">CommonMark</option><option value="Plain text">Plain text</option><option value="MediaWiki">MediaWiki</option><option value="Org-mode">Org-mode</option><option value="ICML">ICML</option><option value="Textile">Textile</option><option value="AsciiDoc">AsciiDoc</option><option value="Man page">Man page</option><option value="DocBook">DocBook</option><option value="DZSlides">DZSlides</option><option value="Slidy">Slidy</option><option value="S5">S5</option><option value="EPUB">EPUB</option><option value="ODT">ODT</option><option value="DOCX">DOCX</option><option value="RTF">RTF</option></select>&nbsp;<input type="submit" name="export" id="export" value="Export"></form>
  </fieldset>
</div>
          
          
        </div>
    </div>
    <script src="jquery.min.js" type="text/javascript"></script><script src="jquery-ui.min.js" type="text/javascript"></script><script src="footnotes.js" type="text/javascript"></script><script src="MathJax.js" type="text/javascript"></script>
    
    <script type="text/javascript">
/* <![CDATA[ */
  $.get("/_user", {}, function(username, status) {
     $("#logged_in_user").text(username);
     if (username == "") {  // nobody logged in
        $("#logoutlink").hide();
        $("#loginlink").show();
     } else {
        $("#logoutlink").show();
        $("#loginlink").hide();
     };
   });
/* ]]> */
</script>
  
</body></html>