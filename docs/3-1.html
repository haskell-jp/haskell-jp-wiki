<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" data-scrapbook-source="https://wiki.haskell.jp/Workshop/HaskellR/3"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Haskell-jp wiki - Workshop/HaskellR/3</title>
    <link href="jquery-ui.min.css" rel="stylesheet" media="print" type="text/css">
        <link href="custom.css" rel="stylesheet" media="screen, projection" type="text/css">
    <link href="print.css" rel="stylesheet" media="print" type="text/css">
    
    <!--[if IE]><link href="/css/ie.css" rel="stylesheet" media="screen, projection" type="text/css" /><![endif]-->
  </head>
  <body>
    <div id="doc3" class="yui-t1">
        <div id="yui-main">
          <div id="maincol" class="yui-b">
            <div id="userbox">
  <noscript>
    <a href="https://wiki.haskell.jp/_login">Login</a>
    <a href="index.html">Logout</a>
  </noscript>
  &nbsp;
  <a id="loginlink" class="login" href="https://wiki.haskell.jp/_login">Login / Get an account</a>
  <a id="logoutlink" class="login" href="index.html">Logout <span id="logged_in_user"></span></a>
</div>
            <ul class="tabs"><li class="selected"><a href="">view</a></li><li><a href="https://wiki.haskell.jp/_edit/Workshop/HaskellR/3">edit</a></li><li><a href="https://wiki.haskell.jp/_history/Workshop/HaskellR/3">history</a></li><li><a href="https://wiki.haskell.jp/_discuss/Workshop/HaskellR/3">discuss</a></li></ul> 
            <div id="content">
  
  <h1 class="pageTitle"><a href="">Workshop/HaskellR/3</a></h1>
  
  <div id="wikipage"><div id="TOC">
<ul>
<li><a href="#%E8%AA%BF%E6%95%B4">調整</a><ul>
<li><a href="#%E5%87%BA%E6%AC%A0%E7%A2%BA%E8%AA%8D">出欠確認</a></li>
<li><a href="#%E6%97%A5%E6%99%82">日時</a></li>
<li><a href="#%E5%A0%B4%E6%89%80">場所</a></li>
</ul></li>
<li><a href="#%E8%B3%87%E6%96%99">資料</a><ul>
<li><a href="#%E5%AE%BF%E9%A1%8C-%E5%87%BA%E9%A1%8Cyuzutechnology">宿題 (出題:<span class="citation">@yuzutechnology</span>)</a></li>
<li><a href="#%E5%AE%BF%E9%A1%8C%E5%9B%9E%E7%AD%94">宿題回答</a><ul>
<li><a href="#seizans"><span class="citation">@seizans</span></a></li>
<li><a href="#master_q"><span class="citation">@master_q</span></a></li>
<li><a href="#s_h_i_g_e_chan"><span class="citation">@s_h_i_g_e_chan</span></a></li>
</ul></li>
<li><a href="#arrow%E3%81%AE%E7%B0%A1%E5%8D%98%E3%81%AA%E8%AA%AC%E6%98%8E-%E8%A7%A3%E8%AA%ACkhibino">Arrowの簡単な説明 (解説:<span class="citation">@khibino</span>)</a></li>
</ul></li>
<li><a href="#%E8%AD%B0%E4%BA%8B%E9%8C%B2">議事録</a><ul>
<li><a href="#%E9%8C%B2%E7%94%BB%E3%81%A8%E5%86%99%E7%9C%9F">録画と写真</a></li>
<li><a href="#%E5%AE%BF%E9%A1%8C%E5%9B%9E%E7%AD%94%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">宿題回答について</a><ul>
<li><a href="#seizans-1"><span class="citation">@seizans</span></a></li>
<li><a href="#master_q-1"><span class="citation">@master_q</span></a></li>
</ul></li>
<li><a href="#arrow%E3%81%AE%E7%B0%A1%E5%8D%98%E3%81%AA%E8%AA%AC%E6%98%8E-%E8%A7%A3%E8%AA%ACkhibino-1">Arrowの簡単な説明 (解説:<span class="citation">@khibino</span>)</a></li>
<li><a href="#%E3%83%8D%E3%82%BF%E6%A1%88%E5%87%BA%E3%81%97">ネタ案出し</a></li>
<li><a href="#%E4%BC%9A%E8%A8%88">会計</a></li>
</ul></li>
<li><a href="#%E6%AC%A1%E5%9B%9E">次回</a></li>
</ul>
</div>

<p><img src="5758670438_6756914019.jpg"></p>
<h1 id="調整">調整</h1>
<h2 id="出欠確認">出欠確認</h2>
<p><a href="http://partake.in/events/2e985699-5b67-4948-a1b4-1810b652971e">初心者Haskell勉強会第3回 - PARTAKE</a></p>
<h2 id="日時">日時</h2>
<p>2011/05/25(水) 19:00-22:00</p>
<h2 id="場所">場所</h2>
<p><a href="http://www.ginza-renoir.co.jp/myspace/mys078.htm">喫茶室ルノアール 横浜関内駅前店 マイスペース1号室</a></p>
<h1 id="資料">資料</h1>
<h2 id="宿題-出題yuzutechnology">宿題 (出題:<span class="citation">@yuzutechnology</span>)</h2>
<p><a href="https://github.com/yuzutechnology/Community-Okabe2011/blob/master/HW001-StacksAndQueues.md">StackとQueueを作ってみよう</a></p>
<h2 id="宿題回答">宿題回答</h2>
<h3 id="seizans"><span class="citation">@seizans</span></h3>
<p><a href="https://github.com/seizans/Algorithms-in-Haskell/blob/master/queue.hs">queue.hs</a> <a href="https://github.com/seizans/Algorithms-in-Haskell/blob/master/stack.hs">stack.hs</a></p>
<h3 id="master_q"><span class="citation">@master_q</span></h3>
<p><a href="https://github.com/master-q/Haskell-Homework/tree/master/20110525_StackAndQueue">20110525_StackAndQueue/</a></p>
<h3 id="s_h_i_g_e_chan"><span class="citation">@s_h_i_g_e_chan</span></h3>
<p><a href="http://springpadit.com/allegronontroppo/7d8c441e/159c/4bdb/9c1c/789698290570">“Stack.hs” :: a note in allegronontroppo’s Springpad</a> <a href="http://springpadit.com/allegronontroppo/f6adf53a/5514/4806/ae8b/bb004254d0a3">“Queue.hs” :: a note in allegronontroppo’s Springpad</a></p>
<h2 id="arrowの簡単な説明-解説khibino">Arrowの簡単な説明 (解説:<span class="citation">@khibino</span>)</h2>
<p><a href="https://github.com/master-q/Haskell-Homework/raw/master/20110525_Arrow/arrow.pdf">スライド(pdf)</a> <a href="https://bitbucket.org/khibino/haskell-beginner">khibino / haskell-beginner / overview – Bitbucket</a></p>
<h1 id="議事録">議事録</h1>
<h2 id="録画と写真">録画と写真</h2>
<p><a href="http://www.ustream.tv/recorded/14946412">録画</a> <a href="https://www.flickr.com/photos/masterq/sets/72157626683782687/">写真</a></p>
<h2 id="宿題回答について">宿題回答について</h2>
<h3 id="seizans-1"><span class="citation">@seizans</span></h3>
<p>(感想として)classの作り方がむずかしかった。</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">class</span> <span class="dt">Stack</span> s <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="ot">  empty ::</span> s b</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="ot">  isempty ::</span> s b <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="ot">  cons ::</span> s b <span class="ot">-&gt;</span> b <span class="ot">-&gt;</span> s b</a></code></pre></div>
<p>の場合のbっていきなり出てきていいの？(&lt;=慣れるしかない。。。) isEmptyはパターンマッチを使っても書ける。↓の例だと順序に注意。</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" title="1">isEmpty (<span class="dt">MakeStack</span> []) <span class="fu">=</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb2-2" title="2">isEmpty _ <span class="fu">=</span> <span class="dt">False</span></a></code></pre></div>
<p>pop関数のパターンマッチには失敗することがあるので、 失敗するパターンにはerror関数で拾うと人間にわかりやすい実行時エラーが出る。 また、ghcの-Wallオプションを有効にするとコンパイル時にさえ警告になる。 というか-Wallオプションは常時使えよ！(by <span class="citation">@khibino</span>)</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" title="1"><span class="ot">pop ::</span> <span class="dt">Stack</span> a <span class="ot">-&gt;</span> (a, <span class="dt">Stack</span> a)</a>
<a class="sourceLine" id="cb3-2" title="2">pop (<span class="dt">MakeStack</span> []) <span class="fu">=</span> <span class="fu">error</span> <span class="st">"attempt to pop an empty stack"</span> <span class="co">-- &lt;= この行が必要</span></a>
<a class="sourceLine" id="cb3-3" title="3">pop (<span class="dt">MakeStack</span> (x<span class="fu">:</span>xs)) <span class="fu">=</span> (x, <span class="dt">MakeStack</span> xs)</a></code></pre></div>
<p>どうしてもパターンの前に“~”を付けて、反駁不能であることを宣言すること。(“反駁不能”についてまとめ中 by <span class="citation">@master_q</span>)</p>
<pre><code>@master_q groupBy' のように内側のパターン照合と if を交換すれば止まるようにできますが、そうではなくて groupBy'' のように書きたいとき には ~ が使えるという話です。わかりにくいかな...
khibino 2 日前
@master_q PreludeのgroupByと同じものを書こうとしてみたときに、groupByBad のように書くと、無限リストの入力を与えたときに止まりません (testBad2)
khibino 2 日前
@master_q さきほどの話の例ですが、こんなのはどうでしょう。 http://ideone.com/6nST9
khibino 2 日前</code></pre>
<p>詳しくは <a href="http://www.sampou.org/haskell/tutorial-j/patterns.html">A Gentle Introduction to Haskell: Patterns</a> を参照。</p>
<p>Queueを↓のようにBatchedQueueな構造にした場合、同じ意味でも異なる構造を取ることがある。 そのためderivingによる自動導出は正しい意味を持たない。自分で同等の関数を実装するべき。</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">data</span> <span class="dt">Queue</span> a <span class="fu">=</span> <span class="dt">MakeQueue</span> ([a], [a])</a>
<a class="sourceLine" id="cb5-2" title="2">       <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Ord</span>, <span class="dt">Show</span>, <span class="dt">Read</span>)</a></code></pre></div>
<p>isEmptyが↓のように定義されているということは、 MakeQueueの右側リストに要素が存在する場合には左側リストが空になってはいけないということになる。(不変条件)</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb6-1" title="1">isEmpty (<span class="dt">MakeQueue</span> (xs, _)) <span class="fu">=</span> <span class="fu">null</span> xs</a></code></pre></div>
<p>dequeue関数は↓のように書かれているが、冗長かもしれない。</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb7-1" title="1">dequeue (<span class="dt">MakeQueue</span> (xs, ys)) <span class="fu">=</span> (queueHead (xs, ys), <span class="dt">MakeQueue</span> (queueTail (xs, ys) ) )</a></code></pre></div>
<p>↓のように簡潔に書ける。</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb8-1" title="1">dequeue (<span class="dt">MakeQueue</span> (x<span class="fu">:</span>xs, ys)) <span class="fu">=</span> (x, <span class="dt">MakeQueue</span> (valid (xs, ys) ) )</a></code></pre></div>
<h3 id="master_q-1"><span class="citation">@master_q</span></h3>
<p>公開インターフェイスはStackのみ全公開にすること。カプセル化がくずれてしまう。</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">module</span> <span class="dt">Stack</span> (<span class="dt">Stack</span>(<span class="fu">..</span>), <span class="dt">SimpleStack</span>(<span class="fu">..</span>)) <span class="kw">where</span> <span class="co">-- SimpleStackの中を弄れてしまうので、、、</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">module</span> <span class="dt">Stack</span> (<span class="dt">Stack</span>(<span class="fu">..</span>), <span class="dt">SimpleStack</span>) <span class="kw">where</span> <span class="co">-- Stack経由でSimpleStackを使うように直す</span></a></code></pre></div>
<p>全体的に不要な括弧が多すぎる。関数適用は演算子よりも優先度が高いので、↓の例では括弧が不要。 (空白に対する恐怖が。。。 by <span class="citation">@master_q</span>)</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb10-1" title="1"><span class="co">-- 括弧が多い例</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="ot">  isEmpty ::</span> (s a) <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="ot">  cons    ::</span> a <span class="ot">-&gt;</span> (s a) <span class="ot">-&gt;</span> (s a)</a>
<a class="sourceLine" id="cb10-4" title="4"><span class="ot">  head    ::</span> (s a) <span class="ot">-&gt;</span> a</a>
<a class="sourceLine" id="cb10-5" title="5"><span class="ot">  tail    ::</span> (s a) <span class="ot">-&gt;</span> (s a)</a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">-- ↑のような括弧ははずすことができる</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="ot">  isEmpty ::</span> s a <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="co">-- "s a"は関数適用、"-&gt;"演算子のようなもの、関数適用の方が優先度が上 慣れろ!!!!</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="ot">  cons    ::</span> a <span class="ot">-&gt;</span> s a <span class="ot">-&gt;</span> s a</a>
<a class="sourceLine" id="cb10-9" title="9"><span class="ot">  head    ::</span> s a <span class="ot">-&gt;</span> a</a>
<a class="sourceLine" id="cb10-10" title="10"><span class="ot">  tail    ::</span> s a <span class="ot">-&gt;</span> s a</a></code></pre></div>
<p>上記のような冗長な記述はhlintコマンドを使えば自動的に教えてくれる。 よくMakefileのtestターゲットにHUnitのテストと共にhlintの適用も入れることがある。(by <span class="citation">@yuzutechnology</span>)</p>
<p>今回の例で、isEmpty関数はempty関数を使って実現できるはずだが、 ↓の例だと“SS ss”のssの型が推論できずにコンパイルエラーになってしまう。 Haskellには型推論があるが、人間で書けるところは人力で書く癖を付けておいた方が(人間の)混乱が少ない。</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb11-1" title="1">   isEmpty (<span class="dt">SS</span> ss) <span class="fu">=</span> <span class="fu">null</span> ss <span class="co">-- これは↓のように記述できるはずだが、、、</span></a>
<a class="sourceLine" id="cb11-2" title="2">   isEmpty <span class="fu">=</span> ( <span class="fu">==</span> empty) <span class="co">-- これは推論できない？うわーん</span></a></code></pre></div>
<p>“=”の右辺で使わないパターンは"_"を使うようにすること。例えば、、、</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb12-1" title="1">    <span class="fu">head</span> (<span class="dt">SS</span> (x<span class="fu">:</span>xs)) <span class="fu">=</span> x <span class="co">-- &lt;= xsは使わないよね？</span></a>
<a class="sourceLine" id="cb12-2" title="2">    <span class="fu">head</span> (<span class="dt">SS</span> (x<span class="fu">:</span>_)) <span class="fu">=</span> x <span class="co">-- &lt;= 使わないなら明示的に"_"で捨てること</span></a></code></pre></div>
<p>前回も指摘したが、「呼び出される回数が多いモノ」から順番にパターンマッチを書くように気をつけること。 errorで拾うパターンは明らかに実行される頻度が低いはず。</p>
<p>さきほど、括弧が多いと指摘したが、 ↓の例の場合“(Maybe s) a”と解釈されないようにするために“Maybe (s a)”と書かなければならない。</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb13-1" title="1"><span class="ot">  tail    ::</span> s a <span class="ot">-&gt;</span> <span class="dt">Maybe</span> (s a) <span class="co">-- Maybeとsがくっつかないようにカッコつける!</span></a></code></pre></div>
<h2 id="arrowの簡単な説明-解説khibino-1">Arrowの簡単な説明 (解説:<span class="citation">@khibino</span>)</h2>
<p>xxxxxxxxxxxx</p>
<h2 id="ネタ案出し">ネタ案出し</h2>
<ul>
<li>宿題第二回のネタは既にある (<span class="citation">@yuzutechnology</span>)</li>
<li>pandocかgititの利用者として困りネタ説明 (<span class="citation">@master_q</span>)</li>
<li>Stateモナドについて (<span class="citation">@master_q</span>)</li>
</ul>
<h2 id="会計">会計</h2>
<figure>
<img src="5758673614_82336d58bf_m.jpg" alt="ルノアールのレシート"><figcaption>ルノアールのレシート</figcaption>
</figure>
<p>(9140円 - 1000円(前回からの繰り越し)) / 7人 = 1200円/人</p>
<h1 id="次回">次回</h1>
<p><a href="4-2.html" class="uri" title="Go to wiki page">4</a></p></div>
</div>
            <div id="footer">powered by <a href="https://github.com/jgm/gitit/tree/master/">gitit</a> × <a href="https://haskellonheroku.com/">Haskell on Heroku</a></div>
          </div>
        </div>
        <div id="sidebar" class="yui-b first">
          <div id="logo">
  <a href="_-1.html" alt="site logo" title="Go to top page"><img src="logo.png"></a>
</div>
                      <div class="sitenav">
  <fieldset>
    <legend>Site</legend>
    <ul>
      <li><a href="_-1.html">Front page</a></li>
      <li><a href="_index.html">All pages</a></li>
      <li><a href="_categories.html">Categories</a></li>
      <li><a href="https://wiki.haskell.jp/_random">Random page</a></li>
      <li><a href="https://wiki.haskell.jp/_activity">Recent activity</a></li>
              <li><a href="https://wiki.haskell.jp/_upload">Upload a file</a></li>
      
      
      <li><a href="Help.html">Help</a></li>
    </ul>
    <form action="https://wiki.haskell.jp/_search" method="get" id="searchform">
     <input type="text" name="patterns" id="patterns" value="">
     <input type="submit" name="search" id="search" value="Search">
    </form>
    <form action="https://wiki.haskell.jp/_go" method="post" id="goform">
      <input type="text" name="gotopage" id="gotopage" value="">
      <input type="submit" name="go" id="go" value="Go">
    </form>
  </fieldset>
</div>
          
                      <div class="pageTools">
  <fieldset>
    <legend>This page</legend>
    <ul>
      <li><a href="https://wiki.haskell.jp/_showraw/Workshop/HaskellR/3">Raw page source</a></li>
      <li><a href="https://wiki.haskell.jp/Workshop/HaskellR/3?printable">Printable version</a></li>
      <li><a href="https://wiki.haskell.jp/_delete/Workshop/HaskellR/3">Delete this page</a></li>
      
    </ul>
    <form action="https://wiki.haskell.jp/Workshop/HaskellR/3" method="post" id="exportbox"><select name="format"><option value="LaTeX" selected="selected">LaTeX</option><option value="ConTeXt">ConTeXt</option><option value="Texinfo">Texinfo</option><option value="reST">reST</option><option value="Markdown">Markdown</option><option value="CommonMark">CommonMark</option><option value="Plain text">Plain text</option><option value="MediaWiki">MediaWiki</option><option value="Org-mode">Org-mode</option><option value="ICML">ICML</option><option value="Textile">Textile</option><option value="AsciiDoc">AsciiDoc</option><option value="Man page">Man page</option><option value="DocBook">DocBook</option><option value="DZSlides">DZSlides</option><option value="Slidy">Slidy</option><option value="S5">S5</option><option value="EPUB">EPUB</option><option value="ODT">ODT</option><option value="DOCX">DOCX</option><option value="RTF">RTF</option></select>&nbsp;<input type="submit" name="export" id="export" value="Export"></form>
  </fieldset>
</div>
          
          
        </div>
    </div>
    <script src="jquery.min.js" type="text/javascript"></script><script src="jquery-ui.min.js" type="text/javascript"></script><script src="footnotes.js" type="text/javascript"></script><script src="MathJax.js" type="text/javascript"></script>
    
    <script type="text/javascript">
/* <![CDATA[ */
  $.get("/_user", {}, function(username, status) {
     $("#logged_in_user").text(username);
     if (username == "") {  // nobody logged in
        $("#logoutlink").hide();
        $("#loginlink").show();
     } else {
        $("#logoutlink").show();
        $("#loginlink").hide();
     };
   });
/* ]]> */
</script>
  
</body></html>